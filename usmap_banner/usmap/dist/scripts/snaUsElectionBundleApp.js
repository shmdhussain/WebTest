function getDeviceType(){var e=Modernizr.mq("only screen and (max-width: 47.9375em)"),t=Modernizr.mq("only screen and (min-width: 48em) and (max-width: 79.9376em)");return deviceType=e?"MOBILE":t?"TABLET":"DESKTOP"}function getDeviceTypeV1(){var e=Modernizr.mq("only screen and (max-width: 767px)"),t=Modernizr.mq("only screen and (min-width: 768px) and (max-width: 819px)"),n=Modernizr.mq("only screen and (min-width: 820px) and (max-width: 1279px)");return deviceTypeV1=e?"MOBILE":t?"SMALL_TABLET":n?"LARGE_TABLET":"DESKTOP"}function getDevice(){return"undefined"==typeof WURFL?getDeviceType():"Smartphone"==WURFL.form_factor||"Other Mobile"==WURFL.form_factor||"Feature Phone"==WURFL.form_factor?"MOBILE":"Tablet"==WURFL.form_factor?"TABLET":getDeviceType()}function getDeviceV1(){return"undefined"==typeof WURFL?getDeviceType():"Smartphone"==WURFL.form_factor||"Other Mobile"==WURFL.form_factor||"Feature Phone"==WURFL.form_factor?"MOBILE":"Tablet"==WURFL.form_factor?"TABLET":"Desktop"==WURFL.form_factor?"DESKTOP":"getDeviceType()"}function debounce(r,o,a){var i;return function(){var e=this,t=arguments,n=a&&!i;clearTimeout(i),i=setTimeout(function(){i=null,a||r.apply(e,t)},o),n&&r.apply(e,t)}}function throttle(r,o,a){var i;return function(){var e=this,t=arguments,n=a&&!i;i=i||setTimeout(function(){i=null,a||r.apply(e,t)},o),n&&r.apply(e,t)}}window.windowInnerWidth=window.innerWidth,window.windowInnerHeight=window.innerHeight,window.windowOrientation=$(window).width()>$(window).height()?"landscape":"portrait",window.snaDeviceType=getDeviceType(),window.snaDeviceTypeV1=getDeviceTypeV1(),window.snaDevice=getDevice(),$(window).on("resize",function(e){var t,n,r,o=window.innerHeight,a=window.innerWidth;(o<a?"landscape":"portrait")!=window.windowOrientation&&(t=$.Event("portrait-landscape-orientation-change-event"),$(window).trigger(t)),window.windowOrientation=o<a?"landscape":"portrait",o==window.windowInnerHeight&&a==window.windowInnerWidth||(window.windowInnerHeight=o,window.windowInnerWidth=a,e=$.Event("sna-orientation-change"),window.event.orientation=windowOrientation,$(window).trigger(e),e=getDeviceType(),window.snaDeviceType!=e&&("DESKTOP"==(window.snaDeviceType=e)?n=$.Event("sna-desktop-layout-in"):"TABLET"==e?n=$.Event("sna-tablet-layout-in"):"MOBILE"==e&&(n=$.Event("sna-mobile-layout-in")),$(window).trigger(n)),n=getDeviceTypeV1(),window.snaDeviceTypeV1!=n&&("DESKTOP"==(window.snaDeviceTypeV1=n)?r=$.Event("sna-desktop-layout-in-v1"):"SMALL_TABLET"==n?r=$.Event("sna-small-tablet-layout-in-v1"):"LARGE_TABLET"==n?r=$.Event("sna-large-tablet-layout-in-v1"):"MOBILE"==n&&(r=$.Event("sna-mobile-layout-in-v1")),$(window).trigger(r)))}),window.usElectionMapConfig={usElectionMapAPIDomain:"http://vmtwebuselections.ext.webdev.skynewsarabia.com/",usElectionMapAPIUrl:"rest/map.json",intervalToFetchDataInSec:30,colors:{repWinnerBgColor:"#CC0033",repWinnerHoverBgColor:"#FF0033",demWinnerBgColor:"#333399",demWinnerHoverBgColor:"#6666CC",inProgressBgColor:"#D3D3D3",inProgressHoverBgColor:"#EBEBEB",strokeColorForStateBorderRepWin:"#FFF",strokeColorForStateBorderDemWin:"#FFF",strokeColorForStateBorderInProgress:"#FFF",demWinnerLabelTextColor:"#FFF",repWinnerLabelTextColor:"#FFF",inProgressLabelTextColor:"rgba(0,0,0,.75)"}};var useMapRefreshIntervalTimerId,activeState={},stateSpecificStyles={},stateSpecificHoverStyles={},statesList={},usMapPluginObj=null,reqAlreadyInProgress=!1;function renderUsMap(){var t=960<=$(window).width()?960:$(window).width(),n=$('<div id="map-content"></div>'),e=.8*t;void 0!==setHeightForUsMapWeb&&(e=setHeightForUsMapWeb(e),$("#map").css("min-height","auto")),$("#map").empty().css("height",e).css("width","100%"),$(n).css("height",e).css("width","100%"),$("#map").html(n),reqAlreadyInProgress||(reqAlreadyInProgress=!0,$.getJSON(usElectionMapConfig.usElectionMapAPIDomain+usElectionMapConfig.usElectionMapAPIUrl,function(e){return void 0!==e.map&&e.map.length<=0?($(n).addClass("no-data").html("تابعونا يوم 8 نوفمبر <br/> مع الخريطة التفاعلية <br/> لعرض نتائج الانتخابات الأميركية <br/> لحظة بلحظة"),void $(".sharingVerticalBar").hide()):($(".legend, .sharingVerticalBar").show(),updateMapsWithData(e),$("#map-content").usmap({click:function(e,t){$("path.selected, rect.selected").removeClass("selected"),$("path."+t.name).addClass("selected"),$("rect."+t.name).addClass("selected"),updateLegendInfo(statesList[(activeState=t).name])},showLabels:!0,labelRadius:0,labelWidth:35,labelHeight:20,labelTextStyles:{"font-size":960<=t?11:9,fill:usElectionMapConfig.colors.inProgressLabelTextColor,stroke:"none","font-family":"Arial,Helvetica,sans-serif","font-weight":400},stateStyles:{fill:usElectionMapConfig.colors.inProgressBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},stateHoverStyles:{fill:usElectionMapConfig.colors.inProgressHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},labelBackingStyles:{fill:usElectionMapConfig.colors.inProgressBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},labelBackingHoverStyles:{fill:usElectionMapConfig.colors.inProgressHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},stateSpecificStyles:stateSpecificStyles,stateSpecificHoverStyles:stateSpecificHoverStyles,stateSpecificLabelBackingStyles:stateSpecificStyles,stateSpecificLabelBackingHoverStyles:stateSpecificHoverStyles,stateHoverAnimation:100}),usMapPluginObj=$("#map-content").usmap("getPluginObject"),updateMapsWithData(e),useMapRefreshIntervalTimerId=window.setInterval(timerIntervalCallback,1e3*usElectionMapConfig.intervalToFetchDataInSec),reqAlreadyInProgress=!1,void(void 0!==callbackForWeb&&callbackForWeb()))}).fail(function(e,t,n){reqAlreadyInProgress=!1}))}function timerIntervalCallback(){reqAlreadyInProgress||(reqAlreadyInProgress=!0,$.getJSON(usElectionMapConfig.usElectionMapAPIDomain+usElectionMapConfig.usElectionMapAPIUrl,function(e){refreshMap(e),reqAlreadyInProgress=!1}).fail(function(e,t,n){reqAlreadyInProgress=!1}))}function updateMapsWithData(e){for(var t,n,r,o,a,i,s=0;s<e.map.length;s++){currentStateData=e.map[s],currentStateData.stateCode,statesList[currentStateData.stateCode]=currentStateData,t={},n={},r={},o={},i={},$("."+currentStateData.stateCode).removeClass("rep_winner dem_winner in_progress"),a="REP"===currentStateData.winner?(t={fill:usElectionMapConfig.colors.repWinnerBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderRepWin},n={fill:usElectionMapConfig.colors.repWinnerHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderRepWin},r={fill:usElectionMapConfig.colors.repWinnerLabelTextColor},o={fill:usElectionMapConfig.colors.repWinnerLabelTextColor},i={fill:usElectionMapConfig.colors.repWinnerLabelTextColor},"rep_winner"):"DEM"===currentStateData.winner?(t={fill:usElectionMapConfig.colors.demWinnerBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderDemWin},n={fill:usElectionMapConfig.colors.demWinnerHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderDemWin},r={fill:usElectionMapConfig.colors.demWinnerLabelTextColor},o={fill:usElectionMapConfig.colors.demWinnerLabelTextColor},i={fill:usElectionMapConfig.colors.demWinnerLabelTextColor},"dem_winner"):(t={fill:usElectionMapConfig.colors.inProgressBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},n={fill:usElectionMapConfig.colors.inProgressHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},r={fill:usElectionMapConfig.colors.inProgressLabelTextColor},o={fill:usElectionMapConfig.colors.inProgressLabelTextColor},i={fill:usElectionMapConfig.colors.inProgressLabelTextColor},"in_progress"),stateSpecificStyles[currentStateData.stateCode]=t,stateSpecificHoverStyles[currentStateData.stateCode]=n,usMapPluginObj&&($("."+currentStateData.stateCode).addClass(a),usMapPluginObj.options.stateSpecificStyles[currentStateData.stateCode]=t,usMapPluginObj.options.stateSpecificHoverStyles[currentStateData.stateCode]=n,usMapPluginObj.options.stateSpecificLabelTextStyles[currentStateData.stateCode]=r,usMapPluginObj.options.stateSpecificLabelTextStyles[currentStateData.stateCode]=o,usMapPluginObj.options.stateSpecificLabelTextStyles[currentStateData.stateCode]=i,usMapPluginObj._getState(currentStateData.stateCode).shape.attr(t),usMapPluginObj._getState(currentStateData.stateCode).labelBacking&&usMapPluginObj._getState(currentStateData.stateCode).labelBacking.attr(t),usMapPluginObj._getState(currentStateData.stateCode).labelText&&usMapPluginObj._getState(currentStateData.stateCode).labelText.attr(r),usMapPluginObj.stateText[currentStateData.stateCode]&&usMapPluginObj.stateText[currentStateData.stateCode].attr(o),usMapPluginObj.stateTextCount[currentStateData.stateCode]&&usMapPluginObj.stateTextCount[currentStateData.stateCode].attr(i),i=getLastUpdatedTimeText(),$(".sna_usem_last_updated_time").html(i))}void 0!==activeState&&void 0!==activeState.name&&updateLegendInfo(statesList[activeState.name])}function refreshMap(e){updateMapsWithData(e)}function getLastUpdatedTimeText(){var e=[];e[0]="JAN",e[1]="FEB",e[2]="MAR",e[3]="APR",e[4]="MAY",e[5]="JUN",e[6]="JUL",e[7]="AUG",e[8]="SEP",e[9]="OCT",e[10]="NOV",e[11]="DEC";var t=new Date;return currentMonth=e[t.getMonth()],currentDate=t.getDate(),currentYear=t.getFullYear(),currentHours=t.getHours().toString(),currentMinutes=t.getMinutes().toString(),currentHours<10&&(currentHours="0"+currentHours),currentMinutes<10&&(currentMinutes="0"+currentMinutes),t="آخر تحديث: ",t+=currentMonth+", "+currentDate+", "+currentYear+", ",t+=currentHours+":"+currentMinutes}function updateLegendInfo(e){$(".sna_usem_state_result_cont").removeClass("hide"),$(".sna_usem_state_result_progress_row, .sna_usem_state_result_winner_row").addClass("hide"),"REP"===e.winner?($(".sna_usem_state_result_winner_row.rep_winner").removeClass("hide"),$(".sna_usem_state_result_winner_row.rep_winner .sna_usem_state_result_winner_row_electoral_votes").html(e.repCandidatesElectoralCounts)):"DEM"===e.winner?($(".sna_usem_state_result_winner_row.dem_winner").removeClass("hide"),$(".sna_usem_state_result_winner_row.dem_winner .sna_usem_state_result_winner_row_electoral_votes").html(e.demCandidatesElectoralCounts)):($(".sna_usem_state_result_progress_row").removeClass("hide"),$(".sna_usem_state_result_progress_row_dem_vote_percent span").html(e.demCandidatePct+"%"),$(".sna_usem_state_result_progress_row_rep_vote_percent span").html(e.repCandidatePct+"%")),$(".sna_usem_state_result_state_info").html(e.stateArabicName)}function setHeightForUsMapWeb(e){var t=.5*document.documentElement.clientHeight;return console.log(e),console.log(t),e=t}function callbackForWeb(){!function(e){hammertime=new Hammer(e,{}),hammertime.get("pinch").set({enable:!0});var t=0,n=0,r=1,o=1,a=0,i=0,s=0,l=0,c="",u=e;hammertime.on("doubletap pan pinch panend pinchend",function(e){if("doubletap"==e.type){c="translate3d(0, 0, 0) scale3d(2, 2, 1) ",o=r=2;try{"matrix(1, 0, 0, 1, 0, 0)"!=window.getComputedStyle(u,null).getPropertyValue("-webkit-transform").toString()&&(c="translate3d(0, 0, 0) scale3d(1, 1, 1) ",o=r=1)}catch(e){}u.style.webkitTransform=c,c=""}1!=r&&(t=a+e.deltaX,n=i+e.deltaY,s=Math.ceil((r-1)*u.clientWidth/2),l=Math.ceil((r-1)*u.clientHeight/2),s<t&&(t=s),t<-s&&(t=-s),l<n&&(n=l),n<-l&&(n=-l)),"pinch"==e.type&&(r=Math.max(.999,Math.min(o*e.scale,4))),"pinchend"==e.type&&(o=r),"panend"==e.type&&(a=t<s?t:s,i=n<l?n:l),1!=r&&(c="translate3d("+t+"px,"+n+"px, 0) scale3d("+r+", "+r+", 1)"),c&&(u.style.webkitTransform=c)})}(document.querySelector("#map-content"))}$(document).ready(function(){renderUsMap()}),jQuery(function(e){"MOBILE"==window.getDeviceV1()||"TABLET"==window.getDeviceV1()?e(window).on("portrait-landscape-orientation-change-event",function(){clearInterval(useMapRefreshIntervalTimerId),renderUsMap()}):e(window).resize(debounce(function(){clearInterval(useMapRefreshIntervalTimerId),renderUsMap()},500,!1))});