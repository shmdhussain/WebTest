function debounce(r,a,s){var n;return function(){var e=this,t=arguments,o=s&&!n;clearTimeout(n),n=setTimeout(function(){n=null,s||r.apply(e,t)},a),o&&r.apply(e,t)}}function throttle(r,a,s){var n;return function(){var e=this,t=arguments,o=s&&!n;n=n||setTimeout(function(){n=null,s||r.apply(e,t)},a),o&&r.apply(e,t)}}window.usElectionMapConfig={usElectionMapAPIDomain:"http://vmtwebuselections.ext.webdev.skynewsarabia.com/",usElectionMapAPIUrl:"rest/map.json",intervalToFetchDataInSec:30,colors:{repWinnerBgColor:"#CC0033",repWinnerHoverBgColor:"#FF0033",demWinnerBgColor:"#333399",demWinnerHoverBgColor:"#6666CC",inProgressBgColor:"#D3D3D3",inProgressHoverBgColor:"#EBEBEB",strokeColorForStateBorderRepWin:"#FFF",strokeColorForStateBorderDemWin:"#FFF",strokeColorForStateBorderInProgress:"#FFF",demWinnerLabelTextColor:"#FFF",repWinnerLabelTextColor:"#FFF",inProgressLabelTextColor:"rgba(0,0,0,.75)"}};var useMapRefreshIntervalTimerId,activeState={},stateSpecificStyles={},stateSpecificHoverStyles={},statesList={},usMapPluginObj=null,reqAlreadyInProgress=!1;function renderUsMap(){var t=960<=$(window).width()?960:$(window).width(),o=$('<div id="map-content"></div>'),e=.8*t;"undefined"!=typeof setHeightForUsMapWeb&&(e=setHeightForUsMapWeb(e),$("#map").css("min-height","auto")),$("#map").empty().css("height",e).css("width","100%"),$(o).css("height",e).css("width","100%"),$("#map").html(o),reqAlreadyInProgress||(reqAlreadyInProgress=!0,$.getJSON(usElectionMapConfig.usElectionMapAPIDomain+usElectionMapConfig.usElectionMapAPIUrl,function(e){return void 0!==e.map&&e.map.length<=0?($(o).addClass("no-data").html("تابعونا يوم 8 نوفمبر <br/> مع الخريطة التفاعلية <br/> لعرض نتائج الانتخابات الأميركية <br/> لحظة بلحظة"),void $(".sharingVerticalBar").hide()):($(".legend, .sharingVerticalBar").show(),updateMapsWithData(e),$("#map-content").usmap({click:function(e,t){$("path.selected, rect.selected").removeClass("selected"),$("path."+t.name).addClass("selected"),$("rect."+t.name).addClass("selected");t=statesList[(activeState=t).name];updateLegendInfo(t)},showLabels:!0,labelRadius:0,labelWidth:35,labelHeight:20,labelTextStyles:{"font-size":960<=t?11:9,fill:usElectionMapConfig.colors.inProgressLabelTextColor,stroke:"none","font-family":"Arial,Helvetica,sans-serif","font-weight":400},stateStyles:{fill:usElectionMapConfig.colors.inProgressBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},stateHoverStyles:{fill:usElectionMapConfig.colors.inProgressHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},labelBackingStyles:{fill:usElectionMapConfig.colors.inProgressBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},labelBackingHoverStyles:{fill:usElectionMapConfig.colors.inProgressHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},stateSpecificStyles:stateSpecificStyles,stateSpecificHoverStyles:stateSpecificHoverStyles,stateSpecificLabelBackingStyles:stateSpecificStyles,stateSpecificLabelBackingHoverStyles:stateSpecificHoverStyles,stateHoverAnimation:100}),usMapPluginObj=$("#map-content").usmap("getPluginObject"),updateMapsWithData(e),useMapRefreshIntervalTimerId=window.setInterval(timerIntervalCallback,1e3*usElectionMapConfig.intervalToFetchDataInSec),reqAlreadyInProgress=!1,void("undefined"!=typeof callbackForWeb&&callbackForWeb()))}).fail(function(e,t,o){reqAlreadyInProgress=!1}))}function timerIntervalCallback(){reqAlreadyInProgress||(reqAlreadyInProgress=!0,$.getJSON(usElectionMapConfig.usElectionMapAPIDomain+usElectionMapConfig.usElectionMapAPIUrl,function(e){refreshMap(e),reqAlreadyInProgress=!1}).fail(function(e,t,o){reqAlreadyInProgress=!1}))}function updateMapsWithData(e){for(var t,o,r,a,s,n,i,l=0;l<e.map.length;l++){currentStateData=e.map[l],currentStateData.stateCode,statesList[currentStateData.stateCode]=currentStateData,t={},o={},r={},a={},n={},$("."+currentStateData.stateCode).removeClass("rep_winner dem_winner in_progress"),s="REP"===currentStateData.winner?(t={fill:usElectionMapConfig.colors.repWinnerBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderRepWin},o={fill:usElectionMapConfig.colors.repWinnerHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderRepWin},r={fill:usElectionMapConfig.colors.repWinnerLabelTextColor},a={fill:usElectionMapConfig.colors.repWinnerLabelTextColor},n={fill:usElectionMapConfig.colors.repWinnerLabelTextColor},"rep_winner"):"DEM"===currentStateData.winner?(t={fill:usElectionMapConfig.colors.demWinnerBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderDemWin},o={fill:usElectionMapConfig.colors.demWinnerHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderDemWin},r={fill:usElectionMapConfig.colors.demWinnerLabelTextColor},a={fill:usElectionMapConfig.colors.demWinnerLabelTextColor},n={fill:usElectionMapConfig.colors.demWinnerLabelTextColor},"dem_winner"):(t={fill:usElectionMapConfig.colors.inProgressBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},o={fill:usElectionMapConfig.colors.inProgressHoverBgColor,stroke:usElectionMapConfig.colors.strokeColorForStateBorderInProgress},r={fill:usElectionMapConfig.colors.inProgressLabelTextColor},a={fill:usElectionMapConfig.colors.inProgressLabelTextColor},n={fill:usElectionMapConfig.colors.inProgressLabelTextColor},"in_progress"),stateSpecificStyles[currentStateData.stateCode]=t,stateSpecificHoverStyles[currentStateData.stateCode]=o,usMapPluginObj&&($("."+currentStateData.stateCode).addClass(s),usMapPluginObj.options.stateSpecificStyles[currentStateData.stateCode]=t,usMapPluginObj.options.stateSpecificHoverStyles[currentStateData.stateCode]=o,usMapPluginObj.options.stateSpecificLabelTextStyles[currentStateData.stateCode]=r,usMapPluginObj.options.stateSpecificLabelTextStyles[currentStateData.stateCode]=a,usMapPluginObj.options.stateSpecificLabelTextStyles[currentStateData.stateCode]=n,usMapPluginObj._getState(currentStateData.stateCode).shape.attr(t),usMapPluginObj._getState(currentStateData.stateCode).labelBacking&&usMapPluginObj._getState(currentStateData.stateCode).labelBacking.attr(t),usMapPluginObj._getState(currentStateData.stateCode).labelText&&usMapPluginObj._getState(currentStateData.stateCode).labelText.attr(r),usMapPluginObj.stateText[currentStateData.stateCode]&&usMapPluginObj.stateText[currentStateData.stateCode].attr(a),usMapPluginObj.stateTextCount[currentStateData.stateCode]&&usMapPluginObj.stateTextCount[currentStateData.stateCode].attr(n),n=getLastUpdatedTimeText(),$(".sna_usem_last_updated_time").html(n))}void 0!==activeState&&void 0!==activeState.name&&(i=statesList[activeState.name],updateLegendInfo(i))}function refreshMap(e){updateMapsWithData(e)}function getLastUpdatedTimeText(){var e=[];e[0]="JAN",e[1]="FEB",e[2]="MAR",e[3]="APR",e[4]="MAY",e[5]="JUN",e[6]="JUL",e[7]="AUG",e[8]="SEP",e[9]="OCT",e[10]="NOV",e[11]="DEC";var t=new Date;return currentMonth=e[t.getMonth()],currentDate=t.getDate(),currentYear=t.getFullYear(),currentHours=t.getHours().toString(),currentMinutes=t.getMinutes().toString(),currentHours<10&&(currentHours="0"+currentHours),currentMinutes<10&&(currentMinutes="0"+currentMinutes),t="آخر تحديث: ",t+=currentMonth+", "+currentDate+", "+currentYear+", ",t+=currentHours+":"+currentMinutes}$(document).ready(function(){renderUsMap()});